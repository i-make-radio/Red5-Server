!function(e,n){function t(e){var n=Array.prototype.splice.call(arguments,1),t=[e,n];d.push(JSON.stringify(t)),console.log(d),c||1!=d.length||(s?(i=i||o(),i.src="r5bridge://ready"):(l&&4!=l.readyState&&(l=null),l=l||new XMLHttpRequest,l.open("HEAD","/!r5_exec?"+ +new Date,!0),l.setRequestHeader("rc",++u),l.send(null)))}function o(){var e=document.createElement("iframe");return e.style.display="none",document.body.appendChild(e),e}function a(e){if("undefined"==typeof e)throw"undefined is not valid parameter";return e instanceof Object?JSON.stringify(e):null===e?"":e}function r(e){for(var n=Array.prototype.splice.call(arguments,1),o=0;o<n.length;++o)n[o]=a(n[o]);t("message",e,n)}var i,l,u=0,d=[],c=0,s="undefined"==typeof n?!0:n,f={},p={},v=function(){if(!d.length)return"";var e="["+d.join(",")+"]";return d.length=0,e},y=function(e){c++;try{return e(),v()}finally{c--}},g=function(e,n){void 0===f[e]&&(f[e]=[]),f[e].push(n);var t=p[e];if(void 0!==t){for(var o=0;o<t.length;++o)n.apply(null,t[o]);p[e]=void 0}},h=function(e,n){console.log(e,n);var t=f[e];if(void 0!==t)for(var o=0;o<t.length;++o)t[o].apply(null,n);else void 0===p[e]&&(p[e]=[]),p[e].push(n)};e.nativeFetchMessages=v,e.nativeEvalAndFetch=y,e.sendToHost=r,e.handleMessageFromNative=h,e.addCallback=g,e.getUnhandledMessages=function(){return p};var m;e.latencyReply=function(){var e=new Date-m;console.log(e),t("log",e)},e.testLatency=function(){m=new Date,t("latency-test")},e.sendButton=function(e,n){t("button",e,n)};var w=function(){t("ready",!0)},b=function(){"complete"===document.readyState?w():window.addEventListener("load",w,!1)};b()}(window,window.injectionUseIframe);